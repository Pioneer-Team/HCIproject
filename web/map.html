<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>Wifi Search</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/cover.css" rel="stylesheet">

    <script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?clientId=ioSTX7saHrsNyTMZgF0n"></script>
    <script type="text/javascript" src="js/geo.js"></script>
    <script src="js/js.cookie.js"></script>

  </head>

  <body>





    <div class="site-wrapper">
      <div class="site-wrapper-inner">
        <div class="cover-container">
          <div class="masthead clearfix">
            <div class="inner">


              <h3 class="masthead-brand">Wifi Search <small>와이파이 검색 시스템</small></h3>

              <nav>
                <ul class="nav masthead-nav">
                  <li class="active"><a href="#">한국어</a></li>
                  <li><a href="#">English</a></a></li>
                </ul>
              </nav>


            </div>
          </div>

          <div class="inner cover">
            <div id="out"></div>



            <div id="map" class="lead" style="width:100%;height:400px;"></div>












            <script>


            //위도경도 표시
            var output = document.getElementById("out");
            output.innerHTML = '<p>위도 : ' + Cookies.get('latitude') + '° <br>경도 : ' + Cookies.get('longitude') + '°</p>';



              var mapOptions = {
              center: new naver.maps.LatLng(Cookies.get('latitude'), Cookies.get('longitude')),
              zoom: 10
              };
              var map = new naver.maps.Map('map', mapOptions);





              var HOME_PATH = window.HOME_PATH || '.';

              var MARKER_SPRITE_X_OFFSET = 29,
                  MARKER_SPRITE_Y_OFFSET = 50,
                  MARKER_SPRITE_POSITION = {
                      "현위치": [0, 0],
                      "wifi": [MARKER_SPRITE_X_OFFSET, 0],

                  };



              var bounds = map.getBounds(),
                  southWest = bounds.getSW(),
                  northEast = bounds.getNE(),
                  lngSpan = northEast.lng() - southWest.lng(),
                  latSpan = northEast.lat() - southWest.lat();

              var markers = [],
                  infoWindows = [];

              for (var key in MARKER_SPRITE_POSITION) {

                    var position = new naver.maps.LatLng(southWest.lat() + latSpan * Math.random(), southWest.lng() + lngSpan * Math.random());

                    var marker = new naver.maps.Marker({
                        map: map,
                        position: position,
                        title: key,
                        icon: {
                            url: HOME_PATH +'/img/example/sp_pins_spot_v3.png',
                            size: new naver.maps.Size(24, 37),
                            anchor: new naver.maps.Point(12, 37),
                            origin: new naver.maps.Point(MARKER_SPRITE_POSITION[key][0], MARKER_SPRITE_POSITION[key][1])
                        },
                        zIndex: 100
                    });

                  var infoWindow = new naver.maps.InfoWindow({
                      content: '<div style="width:150px;text-align:center;padding:10px;">The Letter is <b>"'+ key.substr(0, 1) +'"</b>.</div>'
                  });

                  markers.push(marker);
                  infoWindows.push(infoWindow);
              };

              //

              var marker = new naver.maps.Marker({
              position: new naver.maps.LatLng(Cookies.get('latitude'), Cookies.get('longitude')),
              map: map
              title : "현재위치"

              });
              markers.push(marker);




              naver.maps.Event.addListener(map, 'idle', function() {
                  updateMarkers(map, markers);
              });

              function updateMarkers(map, markers) {

                  var mapBounds = map.getBounds();
                  var marker, position;

                  for (var i = 0; i < markers.length; i++) {

                      marker = markers[i]
                      position = marker.getPosition();

                      if (mapBounds.hasLatLng(position)) {
                          showMarker(map, marker);
                      } else {
                          hideMarker(map, marker);
                      }
                  }
              }

              function showMarker(map, marker) {

                  if (marker.setMap()) return;
                  marker.setMap(map);
              }

              function hideMarker(map, marker) {

                  if (!marker.setMap()) return;
                  marker.setMap(null);
              }

              // 해당 마커의 인덱스를 seq라는 클로저 변수로 저장하는 이벤트 핸들러를 반환합니다.
              function getClickHandler(seq) {
                  return function(e) {
                      var marker = markers[seq],
                          infoWindow = infoWindows[seq];

                      if (infoWindow.getMap()) {
                          infoWindow.close();
                      } else {
                          infoWindow.open(map, marker);
                      }
                  }
              }

              for (var i=0, ii=markers.length; i<ii; i++) {
                  naver.maps.Event.addListener(markers[i], 'click', getClickHandler(i));
              }










/*
             var db = window.openDatabase("resources/db", "1.0", "data", 2 * 1024 * 1024);

             function queryDB(tx) {
               tx.executeSql('SELECT lat FROM data WHERE lat<33', [], function (tx, results) {
                  var len = results.rows.length, i  ;
                  for (i = 0; i < len; i++) {
                  alert(results.rows.item(i).text);
                }
              },  function errorCB(err) {
                    alert("Error QL: "+err.code);
                });
             }

              function errorCB(err) {
                  alert("Error processing SQL: "+err.code);
              }




              db.transaction(queryDB, errorCB);
*/


});





            </script>
          </div>






          <div class="mastfoot">
            <div class="inner">
              <p>Cover template for <a href="http://getbootstrap.com">Bootstrap</a>, by <a href="https://twitter.com/mdo">@mdo</a>.</p>
            </div>
          </div>

        </div>

      </div>

    </div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  </body>
</html>
